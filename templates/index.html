{% extends "base.html" %}

{% block content %}
<section class="hero">
    <div class="hero-content">
        <h1>
            Innovative <br>
            <span class="gradient-text">Web & AI Solutions</span>
        </h1>
        <p>
            React, Flask, 그리고 Deep Learning을 활용하여<br>
            가치 있는 서비스를 만드는 개발자입니다.
        </p>
        <a href="{{ url_for('projects_list') }}" class="btn btn-primary">프로젝트 보기</a>
    </div>
</section>

<section class="section container">
    <div class="profile-section" style="margin-bottom: 6rem;">
        <h3 style="border-left: 4px solid var(--accent-color); padding-left: 1rem; margin-bottom: 2rem;">Profile</h3>
        <div class="profile-grid">
            <div class="profile-info">
                <div class="profile-item">
                    <span class="profile-label">Name</span>
                    <a href="{{ profile.github_url }}" target="_blank" class="profile-value profile-link">{{
                        profile.name }}</a>
                </div>
                <div class="profile-item">
                    <span class="profile-label">Email</span>
                    <a href="mailto:{{ profile.email }}" class="profile-value profile-link">{{ profile.email }}</a>
                </div>
                <div class="profile-item">
                    <span class="profile-label">Phone</span>
                    <a href="tel:{{ profile.phone }}" class="profile-value profile-link">{{ profile.phone }}</a>
                </div>
                <div class="profile-item">
                    <span class="profile-label">Address</span>
                    <a href="https://www.google.com/search?q={{ profile.address|urlencode }}" target="_blank"
                        class="profile-value profile-link">{{ profile.address }}</a>
                </div>
                <div class="profile-item">
                    <span class="profile-label">Education</span>
                    <div class="education-grouped">
                        <span class="institution-name">{{ profile.education.institution }}</span>
                        <div class="education-links" style="display: inline-block; margin-left: 0.5rem;">
                            {% for edu in profile.education.majors %}
                            <a href="{{ edu.url }}" target="_blank" class="profile-value profile-link">{{ edu.label
                                }}</a>
                            {% if not loop.last %} / {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="profile-extra"
                style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--card-border);">
                <span class="profile-label" style="margin-bottom: 1.5rem; display: block;">Education & Training</span>
                <div class="training-groups">
                    {% for group in profile.training_groups %}
                    <div class="training-group" style="margin-bottom: 1.5rem;">
                        <div class="org-name"
                            style="font-weight: 600; color: var(--accent-light); margin-bottom: 0.5rem; font-size: 0.95rem;">
                            {{ group.organization }}
                        </div>
                        <ul class="training-list" style="margin-top: 0; padding-left: 1.2rem;">
                            {% for detail in group.details %}
                            <li class="profile-value"
                                style="font-size: 0.95rem; font-weight: 400; color: var(--text-secondary); margin-bottom: 0.3rem;">
                                {{ detail }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <div class="tech-stack-summary" style="margin-bottom: 6rem;">
        <h3 style="border-left: 4px solid var(--accent-color); padding-left: 1rem; margin-bottom: 2rem;">Technical Stack
        </h3>
        <div class="tech-grid">
            <div class="tech-group">
                <h4>Languages</h4>
                <div class="tech-tags">
                    <span class="tag highlight">Python</span>
                    <span class="tag highlight">Java</span>
                    <span class="tag highlight">JavaScript</span>
                    <span class="tag">SQL</span>
                    <span class="tag">HTML/CSS</span>
                </div>
            </div>
            <div class="tech-group">
                <h4>Frontend & Mobile</h4>
                <div class="tech-tags">
                    <span class="tag highlight">React</span>
                    <span class="tag">Vite</span>
                    <span class="tag">Redux</span>
                    <span class="tag">Bootstrap</span>
                    <span class="tag">Leaflet</span>
                </div>
            </div>
            <div class="tech-group">
                <h4>Backend & Database</h4>
                <div class="tech-tags">
                    <span class="tag highlight">Flask</span>
                    <span class="tag highlight">Spring Boot</span>
                    <span class="tag">SQLAlchemy</span>
                    <span class="tag">JPA</span>
                    <span class="tag">MySQL</span>
                    <span class="tag">JWT / OAuth2</span>
                </div>
            </div>
            <div class="tech-group">
                <h4>AI / ML & Vision</h4>
                <div class="tech-tags">
                    <span class="tag highlight">PyTorch</span>
                    <span class="tag">YOLO (v8/v11)</span>
                    <span class="tag">PatchCore</span>
                    <span class="tag">Anomalib</span>
                    <span class="tag">OpenCV</span>
                </div>
            </div>
            <div class="tech-group">
                <h4>Infrastructure & Tools</h4>
                <div class="tech-tags">
                    <span class="tag">Docker</span>
                    <span class="tag">MQTT</span>
                    <span class="tag">Git</span>
                    <span class="tag">Gradle</span>
                    <span class="tag">OSRM</span>
                </div>
            </div>
        </div>
    </div>

    <div class="category-section" style="margin-bottom: 4rem;">
        <h3 style="border-left: 4px solid var(--accent-color); padding-left: 1rem; margin-bottom: 2rem;">Team Projects
        </h3>
        <div class="grid">
            {% for project in projects if project.category == 'Team Project' %}
            <a href="{{ url_for('project_detail', project_id=project.id) }}" class="card">
                <div class="card-type">{{ project.type }}</div>
                <h3>{{ project.title }}</h3>
                <p>{{ project.summary }}</p>
                <div class="tech-tags">
                    {% for tech in project.tech_list %}
                    <span class="tag">{{ tech }}</span>
                    {% endfor %}
                </div>
            </a>
            {% endfor %}
        </div>
    </div>

    <div class="category-section">
        <h3 style="border-left: 4px solid var(--accent-color); padding-left: 1rem; margin-bottom: 2rem;">Personal Work
        </h3>
        <div class="grid">
            {% for project in projects if project.category == 'Personal Work' %}
            <a href="{{ url_for('project_detail', project_id=project.id) }}" class="card">
                <div class="card-type">{{ project.type }}</div>
                <h3>{{ project.title }}</h3>
                <p>{{ project.summary }}</p>
                <div class="tech-tags">
                    {% for tech in project.tech_list %}
                    <span class="tag">{{ tech }}</span>
                    {% endfor %}
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const canvases = document.querySelectorAll('.profile-canvas');
        const dpr = window.devicePixelRatio || 1;

        canvases.forEach(canvas => {
            const ctx = canvas.getContext('2d');
            const text = canvas.getAttribute('data-text');
            const font = canvas.getAttribute('data-font') || '500 1.1rem Inter';
            const color = canvas.getAttribute('data-color') || '#f8fafc';

            // Set temporary font to measure
            ctx.font = font;
            const metrics = ctx.measureText(text);
            const textWidth = metrics.width;
            const fontSizePart = font.split(' ').find(p => p.includes('rem') || p.includes('px')) || '1.1rem';
            const fontSize = parseFloat(fontSizePart);
            const textHeight = (fontSizePart.includes('rem') ? fontSize * 16 : fontSize) * 1.5;

            // Set canvas size with dpr scaling for sharpness
            canvas.width = textWidth * dpr;
            canvas.height = textHeight * dpr;
            canvas.style.width = `${textWidth}px`;
            canvas.style.height = `${textHeight}px`;

            ctx.scale(dpr, dpr);
            ctx.font = font;
            ctx.fillStyle = color;
            ctx.textBaseline = 'middle';
            ctx.fillText(text, 0, textHeight / 2);
        });
    });
</script>
{% endblock %}